## OAuth Code Injection Attack

In an authorization code injection attack, the attacker attempts to inject a stolen authorization code into the attacker's own session with the client.

Authorization code generated by the OAuth Server is not binded to the user initiated OAuth flow.
Consider a user has Authorization Code from the OAuth Server. If this Authorization Code is hacked by the attacker, then he can use the same client to initiate an OAuth Flow and receives OAuth Code. He then replace the received OAuth Code with the target user OAuth Code. The OAuth server checks Client ID and its Client Secret and Authorization Code has been used or not. Since all these Info holds true, the Auth server returns the access token of Target User. Since, the Auth Code sent is for getting the access token of the user.

![image](https://user-images.githubusercontent.com/21195523/210792994-4436fe89-2ac3-4d51-b688-4fe4ce99f447.png)

## PKCE - Proof Key for Code Exchange.

- Adds Code Verifier and Code Challenge(Hashed Code verifier) in OAuth flow.
  https://auth0.com/docs/get-started/authentication-and-authorization-flow/authorization-code-flow-with-proof-key-for-code-exchange-pkce

#### OAuth Code Flow along with PKCE is the recommended approach for Confidential Clients.

![image](https://user-images.githubusercontent.com/21195523/210821551-2a726e84-f734-4591-a921-e298cb28a92f.png)
